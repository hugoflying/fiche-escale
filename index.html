<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Fiche Escale Interactive</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 10px;
      margin: auto;
      width: 100%;
      max-width: 100%;
    }
    section {
      margin-bottom: 30px;
    }
    h3 {
      background: #000;
      color: #fff;
      padding: 10px;
      margin: 0 -10px 15px;
      text-align: center;
    }
    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 10px;
    }
    .field {
      flex: 1 1 120px;
      display: flex;
      flex-direction: column;
    }
    .field label {
      font-weight: bold;
      margin-bottom: 3px;
      font-size: 0.9em;
    }
    .field input,
    .field select,
    .field textarea {
      padding: 4px;
      font-size: 0.9em;
    }
    textarea {
      height: 150px;
      width: 100%;
    }
    .now-btn {
      margin-top: 4px;
      padding: 3px 5px;
      font-size: 0.75em;
      width: 100%;
    }
    input, textarea { text-transform: uppercase; }
    @media (max-width: 850px) {
      .row {
        flex-direction: column;
      }
      .field {
        flex: 1 1 100%;
      }
    }
    .input-now {
      display: flex;
      gap: 5px;
    }
    .input-now input {
      flex: 1;
    }
    .input-now button {
      width: 100px;
    }
    @media (max-width: 850px) {
      .row {
        flex-direction: column;
      }
      .field {
        flex: 1 1 100%;
      }
      .input-now {
        flex-direction: column;
      }
      .input-now button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div style="position: absolute; top: 10px; right: 20px;">
    <label><input type="radio" name="timeMode" value="local" checked onchange="setTimeMode(this.value)"> Heure locale</label>
    <label><input type="radio" name="timeMode" value="utc" onchange="setTimeMode(this.value)"> UTC</label>
  </div>

<h2>Fiche Escale Vol</h2>

<!-- Toutes les sections HTML existantes ici (conservées telles quelles) -->

<!-- BOUTONS -->
<div class="row">
  <button onclick="window.print()" style="margin-top: 10px; padding: 10px 20px; font-size: 1em;">Exporter en PDF</button>
  <button onclick="document.querySelectorAll('input, select, textarea').forEach(f => f.type === 'checkbox' ? f.checked = false : f.value = '')" style="margin-top: 10px; padding: 10px 20px; font-size: 1em;">Effacer</button>
</div>

<script>
// Fonction de calcul HLE (-40 min) et H-15 (-15 min) à partir de SOBT
function calculateTimeOffset(baseId, targetId, offsetMinutes) {
  const base = document.getElementById(baseId);
  const target = document.getElementById(targetId);
  if (!base || !target || !base.value) return;
  const [h, m] = base.value.split(":".map(Number));
  const baseDate = new Date();
  baseDate.setHours(h);
  baseDate.setMinutes(m);
  baseDate.setMinutes(baseDate.getMinutes() + offsetMinutes);
  const hh = baseDate.getHours().toString().padStart(2, '0');
  const mm = baseDate.getMinutes().toString().padStart(2, '0');
  target.value = `${hh}:${mm}`;
}

// Ajoute l'écouteur pour le champ SOBT s'il existe dans la page
window.addEventListener('DOMContentLoaded', () => {
  const sobtField = document.getElementById('sobt');
  if (sobtField) {
    sobtField.addEventListener('change', () => {
      calculateTimeOffset('sobt', 'hle', -40);
      calculateTimeOffset('sobt', 'h15', -15);
    });
  }
});
</script>

</body>
</html>
